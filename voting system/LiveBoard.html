<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Live Board</title>
  <style>
    body { margin: 0; font-family: Arial, sans-serif; display: flex; flex-direction: column; min-height: 100vh; background: #f8fafc; }
    nav { background: #1e293b; padding: 15px; display: flex; justify-content: center; gap: 25px; position: sticky; top: 0; z-index: 1000; }
    nav:hover { background: #0f172a; box-shadow: 0 2px 12px rgba(56, 189, 248, 0.4); }
    nav a { color: #f1f5f9; text-decoration: none; font-weight: bold; transition: color 0.3s; }
    nav a:hover { color: #38bdf8; }
    nav a.active { color: #38bdf8; text-decoration: underline; }
    h1 { text-align: center; margin: 20px 0; }
    .position { background: #fff; margin: 20px auto; padding: 20px; border-radius: 12px; width: 90%; max-width: 700px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
    .position h2, .position h3 { margin-top: 0; color: #1e293b; }
    .results-table { width:100%; border-collapse:collapse; margin:20px 0; }
    .results-table th, .results-table td { padding:8px 6px; text-align:left; border-bottom:1px solid #e5e7eb; font-size:1em; }
    .results-table th { background:#f1f5f9; color:#1e293b; }
    .results-table tr:last-child td { border-bottom:none; }
    /* Highlight leading candidate in green */
    .leading { background:#bbf7d0; color:#166534; font-weight:bold; }
    footer { background: #1e293b; color: #f1f5f9; text-align: center; padding: 15px; margin-top: auto; }
    .footer-marquee { display: inline-block; white-space: nowrap; animation: marquee 12s linear infinite; font-size: 1em; font-weight: 500; letter-spacing: 1px; }
    @keyframes marquee { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }
  </style>
</head>
<body>
  <nav>
    <a href="voting.html">Voting</a>
    <a href="LiveBoard.html" class="active">Live Board</a>
    <a href="results.html">Results</a>
    <a href="#" id="signoutBtn" style="margin-left:auto;background:#ef4444;color:#fff;padding:8px 18px;border-radius:20px;text-decoration:none;font-weight:bold;">Sign Out</a>
  </nav>

  <main style="flex:1;display:block;">
    <div style="display:flex;justify-content:center;margin-top:32px;margin-bottom:8px;">
      <button class="results-3d" style="padding:16px 40px;font-size:1.5rem;font-weight:700;border-radius:32px;background:linear-gradient(90deg,#38bdf8 0%,#0ea5e9 100%);color:#fff;border:none;box-shadow:0 2px 12px rgba(56,189,248,0.10);cursor:pointer;transition:background 0.3s,transform 0.2s;letter-spacing:1px;">Live Board</button>
    </div>
    <div id="results-container" class="results-container"></div>
  </main>

  <footer>
    <span class="footer-marquee">Â© 2025 Voting System | All rights reserved</span>
  </footer>

  <script>
    // --- LiveBoard Results Display with Leading Highlight ---
    document.addEventListener("DOMContentLoaded", function() {
      function aggregateVotes(LiveBoard) {
        const positions = {
          src: { "John Mensah": 0, "Ama Serwaa": 0 },
          vp: { "Kwame Boateng": 0, "Esi Adjei": 0 },
          nugs: { "Kojo Owusu": 0, "Akua Asante": 0 }
        };
        for (let user in LiveBoard) {
          let votes = LiveBoard[user];
          for (let pos in votes) {
            for (let cand in votes[pos]) {
              positions[pos][cand] += votes[pos][cand];
            }
          }
        }
        return positions;
      }

      function renderLiveBoard(results) {
        const container = document.getElementById('results-container');
        container.innerHTML = '<h2 style="color:#0ea5e9;">LiveBoard (All User Votes)</h2>';
        for (let pos in results) {
          let section = document.createElement('div');
          section.className = 'position';
          section.innerHTML = `<h3>${pos === 'src' ? 'SRC President' : pos === 'vp' ? 'Vice President' : 'Local NUGS President'}</h3>`;
          
          let table = document.createElement('table');
          table.className = 'results-table';
          table.innerHTML = `<tr><th>Candidate</th><th>Votes</th><th>Percent</th></tr>`;

          let totalVotes = Object.values(results[pos]).reduce((a, b) => a + b, 0) || 1;
          let maxVotes = Math.max(...Object.values(results[pos]));

          for (let cand in results[pos]) {
            let percent = ((results[pos][cand] / totalVotes) * 100).toFixed(1);
            let isLeading = results[pos][cand] === maxVotes && maxVotes > 0;
            table.innerHTML += `<tr${isLeading ? ' class="leading"' : ''}>
              <td>${cand}</td>
              <td>${results[pos][cand]}</td>
              <td>${percent}%</td>
            </tr>`;
          }

          section.appendChild(table);
          container.appendChild(section);
        }
      }

      // Always use LiveBoard for results
      let LiveBoard = JSON.parse(localStorage.getItem('LiveBoard') || '{}');
      let results = aggregateVotes(LiveBoard);
      renderLiveBoard(results);

      // Sign out logic
      document.getElementById('signoutBtn')?.addEventListener('click', function(e) {
        e.preventDefault();
        localStorage.removeItem('currentUser');
        window.location.href = 'login.html';
      });
    });
  </script>
</body>
</html>
